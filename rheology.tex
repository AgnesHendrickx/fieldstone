

The reader is referred to Barnes \cite{barn99}
for a discussion and review of non-linear viscous rheologies and 
to Coussot \cite{cous14} for a review of experimental data for yield stress fluid
flows. 

Here is a quick recap of notations:

\begin{center}
\begin{tabular}{ll}
\hline
${\bm \sigma}$ & (full) stress tensor \\
$\sigma_1$, $\sigma_2$, $\sigma_3$ & principal stresses \\ 
${\bm \tau}$   & deviatoric stress tensor \\
$\tau_1$, $\tau_2$, $\tau_3$ & principal stresses \\ 
${\cal I}_1({\bm T})$ & first invariant of tensor ${\bm T}$ \\
${\cal I}_2({\bm T})$ & first invariant of tensor ${\bm T}$ \\
${\cal I}_3({\bm T})$ & first invariant of tensor ${\bm T}$ \\
${\tau}_{e}=\sqrt{{\cal I}_2({\bm \tau})}$ & effective deviatoric stress \\
$\dot{{\varepsilon}}_{e}=\sqrt{{\cal I}_2(\dot{\bm \varepsilon}^d)}$ & effective deviatoric strain rate \\
\hline
\end{tabular}
\end{center}

Note that for incompressible flow, the stress tensor is given by 
${\bm \sigma}=-p {\bm 1} + {\bm \tau}$ so that 
${\cal I}_1({\bm \sigma})=-p {\cal I}_1({\bm 1}) + {\cal I}_1({\bm \tau})$.
Since ${\bm \tau}$ is deviatoric, its first invariant is zero. We then have
${\cal I}_1({\bm \sigma})=-p n_D$ where $n_D$ is the number of dimensions.

%.....................................................................
\subsubsection{Linear viscous aka Newtonian} \index{Newtonian fluid}

Simply put, a Newtonian fluid is a fluid in which the viscous stresses at every point are linearly proportional 
to the local strain rate.
Mathematically speaking, this means that the fourth-order tensor ${\bm C}$ relating the viscous stress 
tensor to the strain rate tensor does not depend on the stress state and velocity of the flow.
\[
{\bm \tau}={\bm C} : \dot{\bm \varepsilon}
\]

One very often make sthe assumption that the fluid is isotropic, i.e. its mechanical properties are the 
same along any direction. As a consequence the fourth order viscosity tensor 
${\bm C}$ is symmetric and will have only two independent real parameters: 
a bulk viscosity coefficient, that defines the resistance of the medium to gradual uniform compression; 
and a dynamic viscosity coefficient $\eta$ that expresses its resistance to gradual shearing, 
(we here neglect the so-called rotational viscosity coefficient which results from a coupling between the fluid flow and the rotation of the individual particles). %wiki

Rather logically we denote by non-Newtonian fluids with are not Newtonian, i.e. their viscosity (tensor)
depends on stress. Such fluids are part of our daily life, e.g. honey, toothpaste, paint, blood, and shampoo.
They are also sometimes denoted as Generalized Newtonian Fluid \index{Generalized Newtonian Fluid}. 
 


%.....................................................................
\subsubsection{Power-law model} \index{Power-law model}

One of the simplest non-Newtonian viscosity model is the power-law model:
\begin{equation}
\eta = K \dot{\varepsilon}_{e}^{(n-1)/2}
\end{equation}
where $n$ and $K$ are parameters. $n$ is called the power-law index.

Note that a Newtonian viscosity is recovered when $n=1$. Also $n$ and $K$ may depend on temperature
\cite[p339]{reddybook2}.

\Literature \cite{enmo97}

%------------------------------
\subsubsection{Carreau model}
\index{Carreau model} 

Note that this model is sometimes called Bird-Carreau in the literature. \index{Bird-Carreau model}
As explained in \cite{reddybook2}, the power-law model poses no restriction on 
how small or large the viscosity may become, which may prove problematic once 
implemented as it can lead to runaway effects (strain rate becomes large $\rightarrow$
viscosity becomes smaller $\rightarrow$ strain rate becomes larger, etc ...).
This problem is alleviated in the so-called Carreau
\footnote{\url{https://en.wikipedia.org/wiki/Carreau_fluid}} model \cite{zifr07}. 
The viscosity is then given by
\begin{equation}
\eta = \eta_\infty + (\eta_0-\eta_\infty) \left(1 + (\lambda \dot{\varepsilon}_{e})^2 \right)^{(n-1)/2}
\end{equation}
where $\eta_0$, $\eta_\infty$, $\lambda$ and $n\in[0,1]$ are material parameters. 
$\lambda$ is called the relaxation time: it is the inverse of the shear rate at which 
the fluid changes from Newtonian to power-law behavior.

At low strain rate a Carreau fluid behaves as a Newtonian fluid with viscosity $\eta_0$.
At intermediate strain rates $\dot{\varepsilon}_{e} \lambda \sim 1$ a Carreau fluid behaves 
as a Power-law fluid. At high strain rate, a Carreau fluid behaves as a Newtonian fluid 
again with viscosity $\eta_\infty$.
 
\begin{center}
\includegraphics[width=8cm]{images/rheology/carreau/carreau.pdf}\\
{\captionfont Carreau model effective viscosity as a function of the product $\lambda \dot{\varepsilon}_{e}$}
\end{center}

\begin{center}
\includegraphics[width=6cm]{images/rheology/carreau/carreau1}\\
{\captionfont \url{https://youtu.be/qErs5zZV4BQ}}
\end{center}

Note that the (Bird)-Carreau-Yasuda model \cite{osru14} is very similar to the standard (Bird)-Carreau:
\begin{equation}
\eta = \eta_\infty + (\eta_0-\eta_\infty) \left(1 + (\lambda \dot{\varepsilon}_{e})^a \right)^{(n-1)/a}
\end{equation}
\index{Bird-Carreau-Yasuda model}

\Literature \cite{berc95,marc00}

%------------------------------
\subsubsection{Bingham model}
\index{Bingham model}

Bingham fluids can sustain an applied stress without any motion occuring. Only when the applied stress exceeds
a yield stress $\tau_0$ then the fluid flows. This translates as follows \cite{reddybook2}:

\begin{eqnarray}
{\bm \tau} &=& \left(  \frac{\tau_0}{\dot{\varepsilon}} + 2 \eta_0  \right)\dot{\bm \varepsilon}^d \qquad 
\text{ if } {\tau}_{e}>\tau_0 \\
{\bm \tau} &=& {\bm 0} \qquad\qquad\qquad\qquad  \text{if } \tau_{e} \leq \tau_0 
\end{eqnarray}
When flow occurs, the effective viscosity is then given by:
\[
\eta_{eff} =  \frac{\tau_0}{\dot{\varepsilon}_e} + 2 \eta_0 
\]
and when the strain rate is large we recover a Newtonian behaviour.
Typical Bingham fluids are mud, slurry, toothpaste.  

When using a velocity-based FEM code, the implementation of this rheological behaviour 
is complicated by the no-flow condition under a given stress. However, our codes
require a relationship between stress and strain rate in the form of an effective viscosity
which cannot be zero. 
This difficulty can be circumvented by implementing Bingham fluids as follows \cite{reddybook2}:

\begin{eqnarray}
{\bm \tau} &=& \left(  \frac{\tau_0(1-\eta/\eta_r)}{\dot{\varepsilon}_e} 
+ 2 \eta_0  \right)\dot{\bm \varepsilon} \qquad \text{ if } \tau_{e}>\tau_0 \\
{\bm \tau} &=& 2 \eta_r \dot{\bm \varepsilon}  \qquad\qquad\qquad\qquad  
\text{if } \tau_{e} \leq \tau_0 
\end{eqnarray}
where $\eta_r$ is a pre-yield viscosity and $\eta/\eta_r<<1$ (typically 1\% or less). This is a form of 
regularisation, and we will see a similar one in the next section.

\Literature: \cite{papa87,blmi97,mizi01,limd02,maky17,syga14,bingham,baru09,been80}

%------------------------------
\subsubsection{Herschel-Bulkley visco-plastic model}
\index{Herschel-Bulkley model}

The Herschel-Bulkley model is effectively a combination of the power-law model and 
a simple plastic model:
\begin{eqnarray}
{\bm s} &=& 2 \left(  K \dot{\varepsilon}_e^{n-1} + \frac{\tau_0}{\dot{\varepsilon}}\right)\dot{\bm \varepsilon} \qquad \text{ if } {\tau}_{e}>\tau_0 \\
\dot{\bm \varepsilon} &=& {\bm 0} \qquad\qquad \text{if }{\tau}_{e} \leq \tau_0 
\end{eqnarray}
in which $\tau_0$ is the yield stress, $K$ the consistency, and $n$ is the flow index \cite{bemj04}.
The flow index measures the degree to which the fluid is shear-thinning ($n<1$) or shear-thickening ($n>1$).
If $n=1$ and $\tau_0=0$ the model reduces to the Newtonian model. 

The term between parenthesis above is the nonlinear effective viscosity. Concretely, the implementation goes as 
follows\footnote{\url{https://en.wikipedia.org/wiki/Herschel-Bulkley_fluid}}:
\[
\eta_{eff} = 
\left\{
\begin{array}{cc}
\eta_0 & \dot{\varepsilon}_e\leq \dot{\varepsilon}_0 \\ 
K \dot{\varepsilon}_e^{n-1} + \frac{\tau_0}{\dot{\varepsilon}_e} & \dot{\varepsilon}_e \geq \dot{\varepsilon}_0
\end{array}
\right.
\]
The limiting viscosity $\eta_0$ is chosen such that 
$\eta_0 =  K \dot{\varepsilon}_0^{n-1} + \frac{\tau_0}{\dot{\varepsilon}_0}$

A large limiting viscosity means that the fluid will only flow in response to a large applied force. 
This feature captures the Bingham-type behaviour of the fluid. 
Note that when strain rates are large, the power-law behavior dominates. 

As we have seen for Bingham fluids, the equations above are not easily amenable to implementation so that 
one usually resorts to regularisation, which is a modification of the 
equations by introducing a new material parameter which controls the exponential 
growth of stress. This way the equation is valid for both yielded and unyielded areas
\cite{blmi97,papa87,zifr07}:
\begin{equation}
\eta_{eff} = K \dot{\varepsilon}_e^{n-1} + \frac{\tau_0}{\dot{\varepsilon}_e} [1 - \exp(-m \dot{\varepsilon}_e)] 
\end{equation}
When the strain rate becomes (very) small a Taylor expansion of the regularisation 
term yields $1- \exp(-m \dot{\varepsilon}) \sim m \dot{\varepsilon} $ so that 
$\eta_{eff} \rightarrow m \tau_0$.

\todo[inline]{Channel flow of wikipedia with analytical solution!}

\Literature: \cite{madd13}. Check dam break problem of \cite{anco09,coan09,bafp09,tagm09,miga09}.


\mscthesis\index{MSc Thesis}: redo the sinking sphere in Bingham or herschel-Bulkley fluid experiment \cite{bemj04}. 

%...........................................................
\subsubsection{The Casson model}

It is described by \cite{barn99} 
\[
\sqrt{\sigma} = \sqrt{\sigma_y} + \sqrt{\eta_p \dot{\varepsilon}_e} 
\]
or, when squaring it:
\[
\sigma = \sigma_y + \eta_p \dot{\varepsilon}_e + 2\sqrt{\sigma_p \eta_p \dot{\varepsilon}_e} 
\]
This modelled has been found to accurately describe the behaviour of synthetic based muds \cite{adlo17}. 

%-------------------------------------------------
\subsubsection{One model to rule them all?}

Let us consider the base equation
\[
\frac{\eta-\eta_\infty}{\eta_0-\eta_\infty} = 
\left[ 1+(K \dot{\varepsilon}_e)^a  \right]^{-(1-n)/a}
\]
This equation is purposefully generic and specific parameter combination choices 
allow to recover any of the above models (and more) \cite{osru14}.
See also an early paper by Cross \cite{cros65} for a somewhat similar equation. 

%\begin{itemize}
%\item Newtonian:  $K=0$ is sufficient
%\item power-law: $\eta << \eta_0$, $\eta >> \eta_\infty$, $a=1$:
%\end{itemize}
Similar conclusions are reached in the following video:
\begin{center}
\includegraphics[width=6cm]{images/rheology/hbyoutube}\\
{\captionfont \url{https://youtu.be/dVCb11dZR7Y}}
\end{center}



%-------------------------------------------------
\subsubsection{Dislocation and Diffusion creep}
\index{Dislocation creep}
\index{Diffusion creep}

The standard dislocation creep effective viscosity is given by:
\[
\eta_{eff}^{ds} = \frac{1}{2} f A^{-1/n} \dot{\varepsilon}_{e}^{(1-n)/n} \exp \left( \frac{Q+pV}{nRT}  \right)
\] 
where $A$ is the pre-exponential scaling factor, $f$ is a scaling factor
representing viscous weakening or strengthening, $Q$ is the activation energy, 
$V$ is the activation volume, $T$ is the absolute temperature, $n$ is the power-law 
exponent, $R$ is the universal gas constant. 

The coefficients $A,n,Q,V$ are material parameters and are obtained in the laboratory 
by means of high pressure/temperature experiments\cite{kawu93}. Unfortunately 
these experiments cannot be run at Earth-like strain rate values ($\sim 10^{-15}\text{s}^{-1}$)
so that extrapolations must be carried out over several orders of magnitude to 
arrive at values we can use in our numerical models. 
The 1/2 factor arises from the relationship between deviatoric stres and strain rate which 
incolves a factor 2.

The factor $f$ is in fact a tuning parameter used to explore end members (e.g. 'weak crust' 
vs 'strong crust'), see discussion in the supplementary material in \cite{hube11}. 
This approach has been extensively used by the SOPALE users community, see 
for instance \cite{wabj08,wabj08b,wabj08c,grpy12}.



Furthermore, we know that several other factors will strongly affect the rheology:
\begin{itemize}
\item water content, or as often mentioned: 'dry' vs 'wet'. Following \cite{kawu93}, 
dry means water-free and wet means water-saturated conditions.
\begin{center}
\includegraphics[width=8cm]{images/rheology/kawu93}\\
{\captionfont Taken from Karato and Wu \cite{kawu93}.}
\end{center}
\Literature: \cite{qubu14} and refs therein for the effects of water
migration on models of subduction dynamics.

\item composition: while one typically assigns olivine properties to the mantle in models, 
the mineral olivine\footnote{\url{https://en.wikipedia.org/wiki/Olivine}} 
is actually a magnesium iron silicate with the formula (Mg$^{2+}$, Fe$^{2+}$)$_2$SiO$_4$.
and the ratio of magnesium to iron varies between the two endmembers of the solid solution series: 
forsterite (Mg-endmember: Mg$_2$SiO$_4$) and fayalite (Fe-endmember: Fe$_2$SiO$_4$).

\item grain size: this only affects diffusion creep mechanisms \cite{kawu93}. 
Grain size varies over several orders of magnitude and also evolves over time and 
its evolution is affected by the ambient deformation and the deformation history.
Dannberg et al \cite{daef17} then used a diffusion creep effective viscosity 
given by:
\[
\eta_{eff}^{df} = \frac{1}{2} A_{df}^{-1} d^m \exp \left( \frac{Q_{df}+pV_{df}}{RT}  \right)
\] 
where $d$ is the (variable) grain size and $m$ the grain size exponent. Grain growth/evolution 
is usually approximated using semi-empirical expressions \cite[section~2.2]{daef17}.
Smaller grains facilitating faster creep.

The evolution of grain size in the lower mantle is discussed in detail by Solomatov 
\cite{solo01,soet02,sore08} and Cerpa et al \cite{ceww17}.



\Literature: \cite{mube18}

\item anisotropy, LPO: 

\item phase changes:

\end{itemize}

\begin{remark}
It is not uncommon to find in the literature effective viscosity formulations written as a function 
of $B$ with $B=A^{-1/n}$ \cite{wabj08,wabj08b,wabj08c}. Also, this $B$ coefficient often contains the conversion 
factor of the next remark.
\end{remark}

\begin{remark}
uniaxial stuff 
An additional coefficient is added to the effective viscosity formula(s ??) \cite{grpy12,grpy13}.
 
\[
3^{-(1+n)/2n}2^{(1-n)/n}
\] 
\cite{ranalli}
\end{remark}

\begin{center}
\includegraphics[width=13cm]{images/rheology/defmap}\\
{\captionfont Deformation mechanism map calculated for grain size $a=0.1mm$. The lightly shaded area indicates 
that deformation mainly occurs by diffusion creep. The densely shaded area indicates that 
deformation mainly occurs by power-law creep. 
The white region indicates that deformation mainly occurs by the Peierls mechanism. The 
solid curves are lines of constant strain rate. The numbers attached to each contour indicate the 
logarithm of the strain rate in the unit of $s^{-1}$ \cite{kayk99}.}
\end{center}




\paragraph{A closer look at the diffusion creep of Karato \& Wu (1993)} In the article, the following equation 
is used: 
\[
\dot{\bm \varepsilon} = A \left(\frac{{\bm \tau}}{\mu}\right) \left(\frac{b}{d}\right)^m \exp \left( -\frac{Q+pV}{RT}\right)
\]
where $\mu$ is the shear modulus ($\sim$80GPa), $b$ is the length of the Burgers vector ($\sim$0.5nm) and 
$d$ is the grain size.
One can express the above equation in terms of second invariants (see Section~\ref{sec:invariants}):
\[
\underline{\dot{\varepsilon}}_{e} 
= A \left(\frac{\underline{\tau}_{e}}{\mu}\right) \left(\frac{b}{d}\right)^m \exp\left( -\frac{Q+pV}{RT} \right)
\]
and assuming a Newtonian linearisation/relation between deviatoric stress 
and strain rate  $\underline{\tau}_{e} = 2 \eta_{df} \underline{\dot\epsilon}_{e}$, one arrive at
\[
\eta_{df} = \frac{1}{2} \left(\frac{A}{\mu}\right)^{-1}  \left(\frac{b}{d}\right)^{-m} \exp\left( \frac{Q+pV}{RT} \right)
\]
or, 
\[
\eta_{df} = \frac{1}{2} \left[ \frac{A}{\mu}   \left(\frac{b}{d}\right)^{m} \right]^{-1} \exp\left( \frac{Q+pV}{RT} \right)
\]
The effective diffusion creep viscosity is independent of strain-rate so that one 
could substitute the total pressure for lithostatic pressure in the equation, assume 
a geotherm and easily compute the predicted viscosity as a function of grain size $d$.

Let us assume that the 1D profile starts from the base of the lithosphere 
(say 120km depth) and ends at the 660 boundary. 
Assume the temperature to increase linearly from 1300\degree C to $T_{bottom}$. At the bottom 
of the lithosphere, the lithostatic pressure is of the order of 
$\rho \cdot g \cdot L \simeq 3000\cdot 10 \cdot 120e3 \simeq 4$GPa. 
At the bottom of the domain, the pressure has increased by $3300\cdot 10 \cdot 630e3 \simeq21$GPa. 

The viscosity profile is plotted hereunder for three different gran sizes, bottom temperature and 
activation volumes (4,5,6 cm$^3$/mol). 

\begin{center}
\includegraphics[width=5.cm]{images/rheology/kawudiff/viscosity1.pdf}
\includegraphics[width=5.cm]{images/rheology/kawudiff/viscosity2.pdf}
\includegraphics[width=5.cm]{images/rheology/kawudiff/viscosity3.pdf}
\end{center}

Although this exercise only provides us with first-order results, we can conclude that 
one can essentially change the diffusion creep effective viscosity by up to 2 orders of 
magnitude simply by choosing key parameters within acceptable ranges. 


%---------------------------------------------------------------------------------
\subsubsection{Combining diffusion and dislocation creep} It is rather common in 
the computational geodynamics to combine both viscosities into one so-called
'effective viscous viscosity' (as opposed to the so-called 'effective plastic viscosity').
The harmonic average is then used:
\begin{equation}
\eta_{eff} = \frac{\eta_{df}\eta_{ds}}{\eta_{df}+\eta_{ds}} 
=\left( \frac{1}{\eta_{df}}+\frac{1}{\eta_{df}} \right)^{-1}
\end{equation}
See for instance \cite{king16}.

However, although this formula seems simple enough, it hides an important fact: 
strain rates are supposed to be additive, i.e. the total strain rate $\dot{\bm \varepsilon}_T$ of the deformation
is the sum of the dislocation strain rate $\dot{\bm \varepsilon}_{ds}$ and the diffusion 
strain rate $\dot{\bm \varepsilon}_{df}$:
\[
\dot{\bm \varepsilon}_{T}=\dot{\bm \varepsilon}_{df}+\dot{\bm \varepsilon}_{ds}
\]
and so are the effective strain rates (the underscore $e$ has been dropped for convenience - see
section~\ref{sec:invariants} for definitions):
\[
\dot{\varepsilon}_{T}=\dot{\varepsilon}_{df}+\dot{\varepsilon}_{ds}
\]
i.e., 
\[
\dot{\varepsilon}_{T}= 
A_{df} \tau \exp\left(-\frac{Q_{df}+pV_{df}}{RT}\right)
+
A_{ds} \tau^n \exp\left(-\frac{Q_{ds}+pV_{ds}}{RT}\right)
\]
where $\tau$ is the effective shear stress.

We know all the coefficients in this equation with the exception of the scalar $\tau$ (the total strain rate
is obtained from the previous nonlinear iteration velocity or previous time-step velocity) so that 
it can be cast under the form $f(\tau)=0$ 
\[
f(\tau)=
\dot{\varepsilon}_{T} - A_{df} \tau \exp\left(-\frac{Q_{df}+pV_{df}}{RT}\right) - A_{ds} \tau^n \exp\left(-\frac{Q_{ds}+pV_{ds}}{RT}\right)
\]
A Newton method can be used where and the iterations will be of the form:
\[
\tau_{n+1} = \tau_n - \frac{f(\tau_n)}{f'(\tau_n)}
\]
where the derivative of the function $f$ with respect to $\tau$ reads:
\[
f'(\tau)=\frac{\partial f}{\partial \tau}=
- A_{df} \exp\left(-\frac{Q_{df}+pV_{df}}{RT}\right) - A_{ds} n \tau^{n-1} \exp\left(-\frac{Q_{ds}+pV_{ds}}{RT}\right)
\]
Also, from the additivity of strain rates follows the harmonic averaging of viscosities:
\[
\dot{\varepsilon}_{T}=\dot{\varepsilon}_{df}+\dot{\varepsilon}_{ds} 
\quad
\quad
\Rightarrow
\quad
\frac{\tau}{2\eta_{eff}}=\frac{\tau}{2\eta_{df}}+\frac{\tau}{2\eta_{ds}}
\quad
\quad
\Rightarrow
\quad
\frac{1}{\eta_{eff}}=\frac{1}{\eta_{df}}+\frac{1}{\eta_{ds}}
\]
so that the algorithm simply writes:
\begin{enumerate}
\item compute $\tau$ iteratively
\item compute $\dot{\varepsilon}_{df}$, $\dot{\varepsilon}_{ds}$
\item compute $\eta_{ds}=\tau/(2\dot{\varepsilon}_{ds})$, $\eta_{df}=\tau/(2\dot{\varepsilon}_{df})$
\item compute $\eta_{eff}$
\end{enumerate}
Note that one can also directly compute $\eta_{eff}$ as $\eta_{eff}=\frac{\tau}{2 \dot{\varepsilon}_T}$
since
\[
\eta_{eff}
=\frac{\tau}{2 \dot{\varepsilon}_T}
=\frac{\tau}{2 \dot{\varepsilon}_{ds}   +  2\dot{\varepsilon}_{df}  }
=\frac{1}{2 \dot{\varepsilon}_{ds}/\tau   +  2\dot{\varepsilon}_{df}/\tau  }
=\frac{1}{1/\eta_{ds} +  1/\eta_{df}  }
\]
In the case where many deformation mechanisms are present, the total strain rate is 
seen as the sum of the strain rates associated to each mechanism:
\[
\dot{\bm \varepsilon}_{T}=\dot{\bm \varepsilon}_{1}+\dot{\bm \varepsilon}_{2} +\dot{\bm \varepsilon}_{3} + \dots
\]
and then
\[
\dot{\varepsilon}_{T}=\dot{\varepsilon}_{1}+\dot{\varepsilon}_{2} +\dot{\varepsilon}_{3} + \dots
\quad
\Rightarrow
\quad
\frac{\tau}{2\eta_{eff}}=\frac{\tau}{2\eta_{1}}+\frac{\tau}{2\eta_{2}}+\frac{\tau}{2\eta_{3}}+ \dots
\quad
\Rightarrow
\quad
\frac{1}{\eta_{eff}}=\frac{1}{\eta_{1}}+\frac{1}{\eta_{2}}+\frac{1}{\eta_{3}}+\dots
\]
Rather importantly, as we will see hereafter, the following variant is implemented 
in some codes (e.g. DOUAR, FANTOM, SOPALE) so as to bypass the costly Newton iterations:
\begin{enumerate}
\item compute $\eta_{ds}$ and $\eta_{df}$ with the {\it same} strainrate, pressure and temperature values
\item average them by means of an harmonic average
\end{enumerate}
In this case, we have
\[
\dot{\varepsilon}_{T}= 
A_{df} \tau_{df} \exp\left(-\frac{Q_{df}+pV_{df}}{RT}\right)
\quad\quad\quad
\dot{\varepsilon}_{T}= 
A_{ds} \tau_{ds}^n \exp\left(-\frac{Q_{ds}+pV_{ds}}{RT}\right)
\]



\paragraph{A concrete example}
Let us consider a vertical section of upper mantle, from 660km depth to 30km depth.
The lithosphere is assumed to be 90km thick. The temperature at the moho (the top
of the domain) is set to 550C, 1330C at the LMB and 1380C at the bottom.
A constant strainrate $\dot{\epsilon}$ is assumed. The density is set to a constant
3300kg/m$^3$ and we assume a lithostatic pressure.
The temperature and pressure fields are shown hereunder:
\begin{center}
\includegraphics[width=6cm]{images/rheology/effvisc/temperature.pdf}
\includegraphics[width=6cm]{images/rheology/effvisc/pressure.pdf}
\end{center}

In what follows, the values obtained with Newton iterations are coined 'new'
and those obtained without are coind 'old'.
The diffusion and dislocation creep viscosities can be
computed for both old and new algorithms and are shown hereunder
(the diffusion creep viscosity is independent of strain rate so
is the same for both):
\begin{center}
\includegraphics[width=6cm]{images/rheology/effvisc/both_mu_ds.pdf}
\includegraphics[width=6cm]{images/rheology/effvisc/both_mu_df.pdf}
\end{center}

Using the algorithm highlighted hereabove we can compute the
composite effective viscosity and compare it with the 'standard'
effective viscosity:
\begin{center}
\includegraphics[width=10cm]{images/rheology/effvisc/both_mueff.pdf}
\end{center}

\todo[inline]{look at folder, codes, clean up, change labels new and old}

%------------------------------
\subsubsection{The von Mises failure criterion}
\index{von Mises}
\input{vMcriterion}

%------------------------------
\subsubsection{The Tresca failure criterion}
\index{Tresca}
\input{trcriterion}

%------------------------------
\subsubsection{The Drucker-Prager failure criterion}
\index{Drucker-Prager}
\input{dpcriterion}

%------------------------------
\subsubsection{The Mohr-Coulomb failure criterion}
\index{Mohr-Coulomb}
\input{mccriterion}

%------------------------------
\subsubsection{The Griffith-Murrell failure criterion}
\index{Griffith-Murrell}

The Griffith-Murrell yield criterion \cite{brau94,brbe95,babr97} is not often used. 
Extending the work of Griffith (1921) to three dimensional stress distributions, 
Murrell (1963) suggested the following criterion for rock failure expressed 
in terms of the principal stresses:
\[
(\sigma_1-\sigma_2)^2 + (\sigma_2-\sigma_3)^2 + (\sigma_3-\sigma_1)^2
+
24T_0 (\sigma_1+\sigma_2+\sigma_3)=0
\]
where $T_0$ is a material property called the tensile strength. In principal stress space, 
this criterion is represented by a paraboloid of revolution around the pressure (or hydrostatic) axis.

Also found:
\[
J_{2D}+12 T_0 p =0
\]

%.........................................................
\subsubsection{The failure envelope, or yield surface} 


A yield surface is a five-dimensional surface in the six-dimensional space of stresses. 
The state of stress of inside the yield surface is elastic. 
When the stress state lies on the surface the material is said to have reached its yield point 
and the material is said to have become plastic. Further deformation of the material causes 
the stress state to remain on the yield surface, even though the surface itself may change shape and 
size as the plastic deformation evolves, this is because stress states that lie outside the yield surface are non-permissible.

The yield surface is usually expressed in terms of (and visualized in) a three-dimensional principal stress space $(\sigma_1,\sigma_2,\sigma_3)$, a two- or three-dimensional space spanned by stress invariants 
or a version of the three-dimensional Haigh-Westergaard space. 


\begin{center}
\includegraphics[width=14cm]{images/rheology/surfaces}\\
{\captionfont yield surfaces in stress space \cite{zico74}}
\end{center} 


\Literature: \cite{sccm13}





%------------------------------
\subsubsection{Peierls creep}
\index{Peierls creep}

Looking at the literature, there seems to be many formulations for the Peierls creep deformation
mechanism but it it appears that a standard formulation for the Peierls creep writes:
\[
\dot{\epsilon} = A \sigma^n \exp \left[ -\frac{Q+pV}{RT} \left(1-(\frac{\sigma}{\sigma_P})^k\right)^q  \right]
\]
and it seems common to take $k=1$, and $n=2$ \cite{gery10,kaka08}
\[
\dot{\epsilon} = A \sigma^2 \exp \left[ -\frac{Q+pV}{RT} \left(1-\frac{\sigma}{\sigma_P}\right)^q  \right]
\]
In Chenin et al. (2019) \cite{chmd19} the authors state that their Peierls creep implementation
relies on parameters from Evans and Goetze (1979) \cite{evgo79} using the approach of 
Kameyama et al (1999) \cite{kayk99}:
\[
\eta^{pe}=\frac{2}{3} \frac{(1-s)/s}{(1+s)/2s} A \; (\varepsilon_e^{ds})^{\frac{1}{n}-1} 
\]
with $A$ for this formulation:
\[
A = \left[ A_p \exp \left( -\frac{Q(1-\gamma)^2}{RT} \right)  \right]^{-1/s} \gamma \sigma_p
\]
where $s$ is an effective stress exponent that depends on the temperature:
\[
s = 2 \gamma \frac{Q}{RT} (1-\gamma)
\]
where $\gamma$ is a fitting parameter. 



\Literature \cite{basv06,buro11,faff11,gagd14,gery10,goev79,kaka08,kako09,kary01,mesk10,zhwa13,chsm18}


%-------------------------------------------------
\subsubsection{Stress limiting rheology}

Taken from \cite{vavv02}:

\[
\eta_y = \tau_y \dot{\epsilon}_y^{-1/n_y} \dot{\epsilon}^{(1/n_y) -1 } 
\]
where the yield stress $\tau_y$, the yield strain rate $\epsilon_y$ and the yield exponent $n_y$ are
prescribed parameters. In this article, $n_y=10$, $\dot{\epsilon}_y=10^{-15}s^{-1}$
When $n_y=1$ the viscosity is constant and given by $\tau_y \dot{\epsilon}_y^{-1/n_y}$.



%-------------------------------------------------
\subsubsection{Arrhenius law}
\index{Arrhenius law}

A purely temperature-dependent dimensional Arrhenius law that emulates the temperature
dependence of viscosity in silicate rock is often employed for mantle rocks 
\cite{albe00,zhzm09,vata11,bogs13b,namu13,boba19,gult19}:
\begin{equation}
\eta(T)=\eta_0 \exp \left( \frac{Q}{R}(\frac{1}{T}-\frac{1}{T_0}) \right)
\end{equation}
where $\eta_0$ is a reference viscosity and $T_0$ its corresponding reference 
temperature.

It can also account for pressure effects as in \cite{lorg18} where the
diffusion creep viscosity (under the assumption of homogeneous grain size)
is temperature- and pressure-dependent:
\[
\eta(T)=\eta_0 \exp \left( \frac{1}{R}(\frac{Q-pV}{T}-\frac{Q}{T_0}) \right)
\]
(I find the minus sign rather suspicious)

%-------------------------------------------------
\subsubsection{Simple parametrisation of the mantle}

Many CITCOMs-based publications \cite{bumb10,budt14} 
have used the following (dimensionless) viscosity for the mantle:
\[
\eta(T,z) = \eta_r(r) \exp(A(0.5-T))
\]
where $\eta_r$ is a depth dependent viscosity profile (usually defined as 
discontinuous linear profiles for various shells)

The non-dimensional activation coefficient is chosen to be $A=9.2103$ in 
\cite{budt14} which leads to a temperature-induced viscosity contrast of $10^4$ (for 
$T\in[0,1]$).

This is also called the Frank-Kamenetskii flow rule, as used in \cite{lemh17}:
\[
\eta' = \eta_0 \exp(-\theta T)
\]
where the the parameters $\eta_0$, $\theta$ account for the local chemical composition of the rock.
\index{Frank-Kamenetskii}

Another temperature-dependent common expression is as follows \cite{flyu84}:
\[
\eta(T)=\eta_\infty \exp \left( \frac{Q}{R}(\frac{1}{T}-\frac{1}{T_\infty} ) \right)
\]
Also, following \cite{flyu84}: For studying transient convection in a non-
Newtonian rheological fluid, it is expedient from a
computational point of view to employ a law
which behaves linearly for low stresses initially
and becomes gradually non-Newtonian only after
a certain threshold stress level has been surpassed \cite{chri84,chyu84}:
\[
\eta(T,p,\tau_2) =\eta(T,p) \frac{1}{A_2 + A_3 \tau_2^2}
\]
where $A_2$ is a parameter describing the linear creep
at low stress levels and $A_3$ governs the transition
stress between Newtonian and non-Newtonian rheologies.

Coltice and Sheppard (2018) \cite{cosh18} use a depth- and temperature-dependent 
viscosity formulation:
\[
\eta(z,T)=\eta_0(z) \exp \frac{Q}{RT}
\]
Note that this expression is supplemented with a pseudo-plastic formulation \cite{roct12}.

\Literature: \cite{king16}

%-------------------------------------------------
\subsubsection{Glen's law for ice}

As it turns out, ice and rocks share similarities in terms of rheology.
Glen’s law is the most commonly used flow law for ice in glaciers and ice sheets \cite{glen55}
and it is actually a power-law type rheology:
\[
\dot{\bm \varepsilon} = A {\bm \tau}^n 
\]
with $n\sim 3$ and $A\sim 2.4\cdot 10^{-24} \text{Pa}^{-3}\cdot \text{s}^{-1}$ at $0\degree$C.
The effective viscosity is then given by
\[
\eta = \frac{1}{2 A \tau_e^{n-1}} 
\]
\begin{center}
\includegraphics[height=5cm]{images/rheology/glen}
\includegraphics[height=5cm]{images/rheology/goko01}\\
{\captionfont Left: Taken from Glen \cite{glen55}; Right: taken from \cite{goko01}.}
\end{center}
Most of these studies suggest values of the power-law exponent $n\sim 2-4$, and there seems to be 
a general indication that the exponent is lower at lower stresses.

The $A$ coefficient above has been found to depend on temperature and is reasonably described 
with an Arrhenius law:
\[
A(T)=A_0 \exp\left( -\frac{Q}{RT} \right)
\]
A standard formulation is the Paterson-Budd law with a fixed Glen exponent $n=3$ and 
a split Arrhenius term \cite{pabu82}:
\[
A=3.615 \cdot 10^{-13} \text{Pa}^{-3}\cdot \text{s}^{-1}, \qquad Q=60 \; \text{kJ}/\text{mol}, \qquad if\quad T<263\text{K} 
\]
\[
A=1.733\cdot 10^{3} \text{Pa}^{-3}\cdot \text{s}^{-1}, \qquad  Q=139 \; \text{kJ}/\text{mol}, \qquad if\quad T>263\text{K}
\]
Be careful that in these two equations the temperature T is the pressure-adjusted temperature \cite{pabu82}.


Note that $A$ is also affected by the water content and the presence of impurities. 

Finally, Glen's law is the standard rheology used for ice-sheet modelling 
but it does not account for the complex evolution of fabric and resulting anisotropy.

\Literature \cite{grev97,krab16,grbl09}


%...........................................
\subsubsection{Elasto-Visco-Plasticity}


Following \cite{chmd19}, one can base the rheological model on the additive decomposition of the 
deviatoric strain rate tensor ${\bm \varepsilon}^d$:
\[
{\bm \varepsilon}^d =
{\bm \varepsilon}^{el}+
{\bm \varepsilon}^{pl}+
{\bm \varepsilon}^{ds}+
{\bm \varepsilon}^{df}+
{\bm \varepsilon}^{pe}
\]
where the five strain rate terms correspond respectively to the elastic, plastic, and viscous creep (dislocation, diffusion, peierls) contributions. 
Rather interestingly, Chenin et al \cite{chmd19} state that "this strain rate equation is nonlinear
and solved locally on cell centroids and vertices in order to define the current effective viscosity 
and stress \cite{poso08}."

\includegraphics[width=4cm]{images/rheology/evp}

\Literature: \cite{hoor89,lopr90,homo90,lova01,anpa19,egat10}

%...........................................
\subsubsection{Anisotropic viscosity}

Following the paper by Lev and Hager (2008) \cite{leha08}, 
the anisotropic viscosity enters the equation of momentum through a 'correction'
term added to the isotropic part of the constitutive equation relating
stress and strain rate \cite{mumh02}:
\[
\sigma_{ij} = -p \delta_{ij} + 2 \eta_N \dot{\varepsilon}_{ij}  - 2(\eta_N-\eta_S)\Lambda_{ijkl}\dot{\varepsilon}_{kl} 
\]
where $\eta_N$ is the normal viscosity and $\eta_S$ is the shear viscosity. 
The fourth order tensor $\Lambda$ reflects the orientation of the directors in space, 
denoted by $\vec{n}$:
\[
\Lambda_{ijkl}=\frac{1}{2} (n_i n_k \delta_{lj} + n_j n_k \delta_{il} + n_i n_l \delta{kj} n_j n_l \delta_{ik} )
- 2 n_i n_j n_k n_l 
\]
Following \cite{modm03,mumh02}, the 'directors' are advected through the model and are 
analogous to particles. The directors are
vector-particles pointing normal to the easy-glide plane or layer,
thus defining the directions associated with $\eta_N$ and $\eta_S$. 
In each time
step of the calculation, the directors are advected and rotated by the
flow, and in return determine the viscosity structure for the next time
step \cite{mumc04}.

\mscthesis\index{MSc Thesis}: redo the Rayleigh-Taylor instabilities with anisotropic lithospheric viscosity.
experiments of Lev \& Hager (2008) \cite{leha08}. 

\Literature: \cite{mumh02,vatb98,mumc04,mumh02,mima04,rida78,saab84}

%...........................................
\subsubsection{Rheology of the lithosphere}


\begin{center}
\includegraphics[height=5cm]{images/rheology/budr08}\\
{\captionfont Schematic view of the three most common first order rheological models of the continental 
lithosphere under a strain rate of 10$^{-14}$s$^{-1}$ . 
In all three models the upper crust has its frictional strength increased with pressure and depth. 
(a) The jelly sandwich model has a weak mid-lower crust and a strong mantle composed of dry olivine. 
(b) The cr\`eme br\^ul\'ee model assumes that the mantle is weak, due to the presence of water and high 
temperature deformation, and the dry and brittle crust determines the strength of the lithosphere. 
(c) The banana split model assumes that the lithosphere as a whole has its strength greatly reduced
due to various strain weakening and feedback processes \cite{budr08}}
\end{center}

\begin{center}
\includegraphics[width=8cm]{images/rheology/bird99}\\
{\captionfont Taken from \cite{bird99}.
Typical vertical distribution of maximum shear stress in continental lithosphere 
undergoing compressional (right) or extensional (left) strain at $10^{-15}$s. 
Friction controls level of shear stress in upper part of crust and sometimes in mantle lithosphere;
then, below brittle/ductile transition, shear stress is controlled by thermally-activated dislocation creep.}
\end{center}

\Literature \cite{buwa06,budr08,rana97a,rana97b}


\todo[inline]{I need to talk about Byerlee's law. \cite{byer78}}

