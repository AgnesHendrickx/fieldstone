
This function receives as argument the coordinates {\tt x,y,z} of a point and 
returns the magnetic vector potential ${\bm A}$ and the magnetic field ${\bm B}$
defined by the equations
\begin{eqnarray}
{\bm B}({\bm r}) &=& \frac{\mu_0}{4\pi} \int\int\int \frac{1}{|{\bm r}-{\bm r}'|^3}
\left[
\frac{3}{|{\bm r}-{\bm r}'|^2} [{\bm M}({\bm r}')\cdot({\bm r}-{\bm r}')]({\bm r}-{\bm r}') - {\bm M}({\bm r}')
\right]
d^3{\bm r}' \\
{\bm A}({\bm r}) &=& 
\frac{\mu_0}{4\pi} \int\int\int \frac{{\bm M}({\bm r}') \times ({\bm r}-{\bm r}')}{|{\bm r}-{\bm r}'|^3}
d^3{\bm r}'
\end{eqnarray}
In the SI system, the units of A are $V.s.m^{-1}$ 
and are the same as that of momentum per unit charge.

We can also compute the magnetic scalar potential $\psi$ as follows:
\[
\Psi (\vec r)= \frac{1}{4\pi} \int\int\int \frac{{\vec M}({\vec r}') \cdot ({\vec r}-{\vec r}')}{|{\vec r}-{\vec r}'|^3} 
d^3{\vec r}'
\]
and the magnetic field vector $\vec H$:
\[
\vec H = -\vec\nabla \psi = 
- \int\int\int 
\left[
 M_x({\vec r}') \underbrace{\vec\nabla \frac{ (x-x')}{|{\vec r}-{\vec r}'|^3}}_{\vec\Theta_x} +   
 M_y({\vec r}') \underbrace{\vec\nabla \frac{ (y-y')}{|{\vec r}-{\vec r}'|^3}}_{\vec\Theta_y} +   
 M_z({\vec r}') \underbrace{\vec\nabla \frac{ (z-z')}{|{\vec r}-{\vec r}'|^3}}_{\vec\Theta_z}    
\right] 
d^3{\vec r}'
\]
\begin{eqnarray}
\vec\Theta_x 
&=& \vec\nabla \frac{ (x-x')}{ [(x-x')^2+(y-y')^2+(z-z')^2]^{3/2}   } \\
&=&
\frac{1}{|{\vec r}-{\vec r}'|^6}
\left(\begin{array}{c}
1 \cdot |{\vec r}-{\vec r}'|^3 - (x-x') \cdot 3 (x-x') |{\vec r}-{\vec r}'| \\ \\
0 \cdot |{\vec r}-{\vec r}'|^3 - (x-x') \cdot 3 (y-y') |{\vec r}-{\vec r}'| \\ \\
0 \cdot |{\vec r}-{\vec r}'|^3 - (x-x') \cdot 3 (z-z') |{\vec r}-{\vec r}'| 
\end{array}\right) \\
&=& 
\frac{1}{|{\vec r}-{\vec r}'|^5}
\left(\begin{array}{c}
|{\vec r}-{\vec r}'|^2 - 3(x-x') (x-x')  \\ \\
- 3(x-x')(y-y')  \\ \\
- 3(x-x')(z-z')  
\end{array}\right) \\ 
\vec\Theta_y 
&=& \vec\nabla \frac{ (y-y')}{ [(x-x')^2+(y-y')^2+(z-z')^2]^{3/2}   } \\
&=& 
\frac{1}{|{\vec r}-{\vec r}'|^5}
\left(\begin{array}{c}
- 3(y-y') (x-x')  \\ \\
|{\vec r}-{\vec r}'|^2 - 3(y-y')(y-y')  \\ \\
- 3(y-y')(z-z')  
\end{array}\right) \\ 
\vec\Theta_z 
&=& \vec\nabla \frac{ (z-z')}{ [(x-x')^2+(y-y')^2+(z-z')^2]^{3/2}   } \\
&=& 
\frac{1}{|{\vec r}-{\vec r}'|^5}
\left(\begin{array}{c}
- 3(z-z') (x-x')  \\ \\
- 3(z-z')(y-y')  \\ \\
|{\vec r}-{\vec r}'|^2 - 3(z-z')(z-z')  
\end{array}\right) \\ 
\end{eqnarray}


