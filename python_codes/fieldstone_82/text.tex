


%......................................
\subsubsection*{Manufactured solution (bench=1)}

This benchmark begins by postulating a polynomial solution 
to the 3D Stokes equation (see Dohrmann \& Bochev (2004) \cite{dobo04}):
\begin{equation}
\vec{\upnu}(x,y,z)
=
\left(
\begin{array}{c}
x+x^2+xy+x^3y \\
y + xy + y^2 + x^2 y^2\\
-2z - 3xz - 3yz - 5x^2 yz
\end{array}
\right)
\label{eqbur2}
\end{equation}
and
\begin{equation}
p(x,y,z) = xyz + x^3 y^3z - 5/32
\end{equation}
The corresponding right-hand side is computed in Section~\ref{mms3}.
The domain is a unit cube and velocity boundary conditions
simply use Eq. (\ref{eqbur2}).
Note that the pressure fulfills $\int_\Omega p(x,y,z) dV = 0.$

\begin{center}
\includegraphics[width=8cm]{python_codes/fieldstone_82/results/mms/vrms.pdf}
\includegraphics[width=8cm]{python_codes/fieldstone_82/results/mms/conv.pdf}\\
{\captionfont Results obtained for three levels of quadrature, with $\beta=0$ (i.e.
viscosity is constant and equal to 1).}
\end{center}

Somewhat surprisingly, the pressure convergence is not exactly quadratic but seems to be
around 1.8. Also, the $2\times 2\times 2$ 
quadrature yields better results than the $3\times 3\times 3$ or $4\times 4 \times 4$.

%......................................
\subsubsection*{Stokes sphere (bench=3)}

A sphere of radius 0.123 is placed in the middle of the domain. It has a density excess $\delta\rho=0.1$
with respect to the surrounding fluid which has a density $\rho_{fluid}=0$ or $\rho_{fluid}=1$. 
Boundary conditions are no slip on all sides. Gravity is $\vec{g}=-\vec{e}_z$.

\begin{center}
\includegraphics[width=7.5cm]{python_codes/fieldstone_82/results/sphere/vel.png}
\includegraphics[width=7.5cm]{python_codes/fieldstone_82/results/sphere/p.png}\\
\includegraphics[width=5cm]{python_codes/fieldstone_82/results/sphere/u.png}
\includegraphics[width=5cm]{python_codes/fieldstone_82/results/sphere/v.png}
\includegraphics[width=5cm]{python_codes/fieldstone_82/results/sphere/w.png}\\
{\captionfont Resolution $24\times 24\times 24$. Quadrature $2\times 2 \times 2$. 
$\rho_{fluid}=0$}
\end{center}


\begin{center}
\includegraphics[width=8cm]{python_codes/fieldstone_82/results/sphere/vrms.pdf}\\
{\captionfont Root mean square velocity as a function of the mesh size $h$
for three different quadrature rules.}
\end{center}


\begin{center}
\includegraphics[width=7cm]{python_codes/fieldstone_82/results/sphere/u.pdf}
\includegraphics[width=7cm]{python_codes/fieldstone_82/results/sphere/v.pdf}\\
\includegraphics[width=7cm]{python_codes/fieldstone_82/results/sphere/w.pdf}
\includegraphics[width=7cm]{python_codes/fieldstone_82/results/sphere/p.pdf}\\
{\captionfont min and max values of $u$, $v$, $w$ and $p$ as a function of $h$.}
\end{center}

\begin{center}
\includegraphics[width=7cm]{python_codes/fieldstone_82/results/sphere/build.pdf}
\includegraphics[width=7cm]{python_codes/fieldstone_82/results/sphere/solve.pdf}\\
{\captionfont Matrix build and solve time as a function of $h$.}
\end{center}
