\lstinputlisting[language=bash,basicstyle=\small]{python_codes/fieldstone_102/keywords}

\begin{center}
Code at \url{https://github.com/cedrict/fieldstone/tree/master/python_codes/fieldstone_102}
\end{center}

\par\noindent\rule{\textwidth}{0.4pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center}
\includegraphics[width=1cm]{images/fortran/fortran} 
\end{center}

This stone is a 'simple' approach to the implementation of Conformal Refinement. The code was written 
a few years prior to my working on fieldstone, so it is in Fortran. 

Let us start with a very simple test: the mesh counts $9\times 7=63$ elements.
The greyed elements are those to be refined. We then first flag the nodes which compose them and these are shown in teal color.
Based on this information we can then consider each element in the mesh and assign it a type, based on whether or not one or more nodes are flagged:

\begin{center}
\input{tikz/tikz_cr_1}
\end{center}

The type is stored in the elemental array {\tt crtype} while the nodes belonging to elements to be refined are stored in {\tt crnode}.
The types are as follows:

\begin{center}
\input{tikz/tikz_cr_2}
\end{center}

Note that the refinement above is based on a 3x3 refinement of elements. One could also carry out a 5x5-type
refinement which would then rely on the following elements (and their rotated versions):
\begin{center}
\input{tikz/tikz_cr_3}
\end{center}

After running the code, various vtu files are to be found in the OUT folder.

%................................................................
\paragraph{Case test=0}

\begin{center}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test0/mesh1}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test0/mesh2}\\
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test0/mesh3}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test0/mesh4}\\
{\captionfont opla}
\end{center}

%................................................................
\paragraph{Case test=1}

\begin{center}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test1/vel}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test1/press}\\
{\captionfont Initial resolution 10x10}
\end{center}

%................................................................
\paragraph{Case test=2}

\begin{center}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test2/vel}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test2/press}\\
{\captionfont Initial resolution 10x10}
\end{center}


%................................................................
\paragraph{Case test=3}

\begin{center}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test3/vel}
\includegraphics[width=6cm]{python_codes/fieldstone_102/results/test3/press}\\
{\captionfont Initial resolution 10x10}
\end{center}
















